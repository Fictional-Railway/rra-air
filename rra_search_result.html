<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>空席照会結果|琉球リゾート航空</title>

<style type="text/css">
/* --- スタイルは変更なし (省略) --- */
body { font-family: "MS Pゴシック", "MS PGothic", "ヒラギノ角ゴ Pro W3", sans-serif; font-size: 12px; line-height: 1.5; background-color: #FFFFFF; margin: 0; padding: 0; }
table.main-layout { width: 760px; border: 0; border-spacing: 0; border-collapse: collapse; background-color: #FFFFFF; }
.header-top { padding: 10px; border-bottom: 3px solid #000080; }
.logo-text { font-size: 28px; font-weight: bold; color: #000080; font-family: "Arial Black", sans-serif; }
.logo-subtext { font-size: 12px; font-weight: bold; color: #CC0000; }
.global-nav { background-color: #EEEEFF; border-bottom: 1px solid #999999; padding: 5px; text-align: center; font-size: 11px; }
.global-nav a { color: #0000CC; text-decoration: none; }
.global-nav a:hover { color: #FF0000; text-decoration: underline; }
.left-nav { width: 180px; padding: 10px; background-color: #F0F0F0; border-right: 1px dashed #999999; }
.left-nav h4 { font-size: 13px; font-weight: bold; color: #FFFFFF; background-color: #0055AA; padding: 3px; margin-top: 10px; margin-bottom: 5px; }
.left-nav ul { margin: 0 0 10px 15px; padding: 0; list-style-type: square; }
.left-nav li { margin-bottom: 5px; }
@keyframes blinker { 50% { opacity: 0; } }
.blinking-new { animation: blinker 1.0s linear infinite; color: red; font-weight: bold; font-size: 10px; }
.main-content { padding: 15px; }
.main-content h3 { font-size: 16px; color: #000080; border-bottom: 2px solid #000080; }
.footer { border-top: 1px solid #999999; padding: 10px; text-align: center; font-size: 10px; color: #666666; }
.search-criteria { border: 1px solid #0055AA; background-color: #F0F0FF; padding: 10px; }
.search-criteria span { font-size: 14px; font-weight: bold; }
table.search-results { width: 100%; border-collapse: collapse; border: 2px solid #0055AA; font-size: 12px; }
table.search-results th { background-color: #E0E0FF; padding: 6px; border: 1px solid #999999; font-weight: bold; }
table.search-results td { padding: 6px; border: 1px solid #CCCCCC; text-align: center; }
table.search-results tr.row-alt { background-color: #F7F7F7; }
.seat-symbol { font-size: 16px; font-weight: bold; font-family: "Arial", sans-serif; }
.seat-available { color: #0000CC; } 
.seat-few { color: #FF8C00; }     
.seat-full { color: #CC0000; }      
.legend-box { border: 1px dotted #999999; background-color: #FAFAFA; padding: 8px; font-size: 11px; }
.submit-button { font-weight: bold; padding: 8px 15px; background-color: #DDDDDD; border: 2px outset #CCCCCC; cursor: pointer; font-size: 13px; }
.submit-button:active { border-style: inset; }

</style>
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000CC" vlink="#800080">

<table class="main-layout" align="center" bgcolor="#999999" cellspacing="1" cellpadding="0">
    
    <tr bgcolor="#FFFFFF">
        <td colspan="2" class="header-top">
            <span class="logo-text">RRA 琉球リゾート航空</span><br>
            <span class="logo-subtext">"Best travel with RRA"</span>
        </td>
    </tr>
    
    <tr bgcolor="#EEEEFF">
        <td colspan="2" class="global-nav">
            <font size="2">
                <b>[ <a href="./index.html">ホーム</a> ]</b>
                | <b>[ <a href="./flight-info.html">運航情報</a> ]</b>
                | <b>[ <a href="#">時刻表</a> ]</b>
                | <b>[ <a href="#">運賃案内</a> ]</b>
                | <b>[ <a href="#">会社概要</a> ]</b>
                | <b>[ <a href="#">English</a> ]</b>
            </font>
        </td>
    </tr>

    <tr>
        <td class="left-nav" valign="top">
            <h4>■ 空席照会・ご予約</h4>
            <ul><li><a href="#">国内線予約</a></li><li><a href="#">予約確認・変更</a></li></ul>
            <h4>■ RRAマイレージ</h4>
            <ul><li><a href="#">ログイン</a></li><li><a href="#">新規入会</a></li></ul>
            <h4>■ ツアー情報 <span class="blinking-new">New!</span></h4>
            <ul><li><a href="#">石垣・宮古 島旅</a></li><li><a href="#">那覇フリープラン</a></li></ul>
            <h4>■ 便利な情報</h4>
            <ul><li><a href="#">機材・シート紹介</a></li><li><a href="#">お問い合わせ</a></li><li><a href="#">サイトマップ</a></li></ul>
            <br><p align="center">
                <a href="http://www.w3.org/html/logo/">
                <img src="https://www.w3.org/Icons/valid-html401" alt="Valid HTML 4.01!" height="31" width="88" border="0">
                </a>
            </p>
        </td>

        <td class="main-content" valign="top">
            
            <h3><font color="#000080">空席照会結果</font></h3>
            
            <p>RRA 琉球リゾート航空をご利用いただき、ありがとうございます。<br>
            ご希望の便を選択し、[ 次へ進む ] ボタンを押してください。</p>

            <div class="search-criteria" id="search-criteria-display">
                <font size="2"><b>【ご希望の検索条件】</b></font><br>
                <span>読み込み中...</span>
            </div>
            
            <br>
            
            <p align="left">
                <font size="2">
                <b>[出発時刻で絞り込む]</b>
                | <a href="javascript:void(0);" onclick="filterFlights('08');">08時台</a>
                | <a href="javascript:void(0);" onclick="filterFlights('10');">10時台</a>
                | <a href="javascript:void(0);" onclick="filterFlights('13');">13時台</a>
                | <a href="javascript:void(0);" onclick="filterFlights('16');">16時台</a>
                | <a href="javascript:void(0);" onclick="resetFilter();">全て表示</a>
                </font>
            </p>

            <form action="rra_passenger_info.html" method="GET">
            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                <tr>
                    <td class="legend-box">
                        <b>【空席状況の見方】</b>
                        <span class="seat-symbol seat-available">○</span>：空席あり
                        <span class="seat-symbol seat-few">△</span>：残りわずか
                        <span class="seat-symbol seat-full">×</span>：満席
                    </td>
                    <td align="right">
                        <font size="2">[ <a href="#">前日の空席</a> | <a href="#">翌日の空席</a> ]</font>
                    </td>
                </tr>
            </table>

            <table class="search-results" id="flight-results-table" cellpadding="5" cellspacing="0">
                <tr align="center">
                    <th>選択</th>
                    <th>便名</th>
                    <th>出発</th>
                    <th>到着</th>
                    <th>使用機材</th>
                    <th>空席</th>
                </tr>
                </table>
            
            <br>
            
            <font size="1" color="#333333">
                ※空席状況は、検索時点で予約可能な座席数を表示しています。<br>
                ※「△」は残り10席以下の場合に表示されます。<br>
                ※この画面で便を選択しても、予約は完了しません。
            </font>

            <hr size="1" color="#CCCCCC">

            <p align="center">
                <input type="submit" value=" 次へ進む (お客様情報入力) " class="submit-button">
            </p>
            
            </form>

        </td>
    </tr>
    
    <tr bgcolor="#FFFFFF">
        <td colspan="2" class="footer">
            <font size="1">
            (C) 1999-2025 Ryukyu Resort Airlines All Rights Reserved.<br>
            * このホームページは Internet Explorer 5.5 / Netscape 6 での閲覧を推奨します。
            </font>
        </td>
    </tr>

</table>

<script type="text/javascript">
// ------------------------------------------
// ▼▼▼ 全てのフライトデータ (データベースの代わり) ▼▼▼
// ------------------------------------------
var FLIGHT_DATA = [
    // ----------------------------------------------------
    // 往路：那覇 (OKA) 発
    // ----------------------------------------------------
    // 那覇 (OKA) ↔ 石垣 (ISG) 路線
    { route: 'OKA-ISG', no: 'RRA201', depTime: '08:30', arrTime: '09:25', aircraft: 'MD-90', seats: '○' },
    { route: 'OKA-ISG', no: 'RRA203', depTime: '10:15', arrTime: '11:10', aircraft: 'A300', seats: '△' },
    { route: 'OKA-ISG', no: 'RRA205', depTime: '13:00', arrTime: '13:55', aircraft: 'MD-90', seats: '×' },
    { route: 'OKA-ISG', no: 'RRA207', depTime: '16:00', arrTime: '16:55', aircraft: 'B737', seats: '○' },
    
    // 那覇 (OKA) ↔ 宮古 (MMY) 路線
    { route: 'OKA-MMY', no: 'RRA101', depTime: '09:00', arrTime: '09:50', aircraft: 'MD-90', seats: '○' },
    { route: 'OKA-MMY', no: 'RRA103', depTime: '13:00', arrTime: '13:50', aircraft: 'B737', seats: '△' },
    { route: 'OKA-MMY', no: 'RRA105', depTime: '16:45', arrTime: '17:35', aircraft: 'A300', seats: '○' },

    // ----------------------------------------------------
    // 復路：那覇 (OKA) 行き (新しいデータ)
    // ----------------------------------------------------
    // 石垣 (ISG) ↔ 那覇 (OKA) 路線
    { route: 'ISG-OKA', no: 'RRA202', depTime: '09:50', arrTime: '10:45', aircraft: 'MD-90', seats: '○' },
    { route: 'ISG-OKA', no: 'RRA204', depTime: '11:40', arrTime: '12:35', aircraft: 'A300', seats: '○' },
    { route: 'ISG-OKA', no: 'RRA206', depTime: '14:20', arrTime: '15:15', aircraft: 'MD-90', seats: '△' },
    { route: 'ISG-OKA', no: 'RRA208', depTime: '18:10', arrTime: '19:05', aircraft: 'B737', seats: '○' },

    // 宮古 (MMY) ↔ 那覇 (OKA) 路線
    { route: 'MMY-OKA', no: 'RRA102', depTime: '11:00', arrTime: '11:50', aircraft: 'MD-90', seats: '△' },
    { route: 'MMY-OKA', no: 'RRA104', depTime: '14:40', arrTime: '15:30', aircraft: 'B737', seats: '○' },
    { route: 'MMY-OKA', no: 'RRA106', depTime: '18:30', arrTime: '19:20', aircraft: 'A300', seats: '×' },
];

// 当時のJSでURLのパラメータを取得するために使われた簡易関数 (変更なし)
function getParameterByName(name) {
    name = name.replace(/[\[\]]/g, "\\$&");
    var url = window.location.href;
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}

// ------------------------------------------
// ▼▼▼ 動的テーブル生成関数 ▼▼▼
// ------------------------------------------
function generateFlightTable(depCode, arrCode) {
    var tableBody = document.getElementById('flight-results-table');
    if (!tableBody) return;

    // ヘッダー行以外の既存行をすべて削除 (念のため)
    while (tableBody.rows.length > 1) {
        tableBody.deleteRow(1);
    }
    
    var routeCode = depCode + '-' + arrCode;
    var filteredFlights = FLIGHT_DATA.filter(function(flight) {
        return flight.route === routeCode;
    });

    if (filteredFlights.length === 0) {
        // 該当便がない場合の表示
        var newRow = tableBody.insertRow(-1);
        newRow.innerHTML = '<td colspan="6"><font color="red"><b>ご指定の区間での運航便は見つかりませんでした。</b></font></td>';
        return;
    }

    // フィルタリングされたデータでテーブル行を生成
    filteredFlights.forEach(function(flight, index) {
        var row = tableBody.insertRow(-1);
        // 交互の背景色 (row-alt) を適用
        if (index % 2 !== 0) {
            row.className = 'row-alt';
        }

        var isAvailable = flight.seats !== '×';
        var seatClass = flight.seats === '○' ? 'seat-available' : (flight.seats === '△' ? 'seat-few' : 'seat-full');

        // セルにHTMLを直接挿入 (innerHTMLを使うのが当時の手法)
        row.innerHTML = 
            '<td>' + 
                (isAvailable ? ('<input type="radio" name="selected_flight" value="' + flight.no + '">') : '&nbsp;') +
            '</td>' +
            '<td>' + flight.no + '</td>' +
            '<td><b>' + flight.depTime + '</b> (' + depCode + ')</td>' +
            '<td><b>' + flight.arrTime + '</b> (' + arrCode + ')</td>' +
            '<td>' + flight.aircraft + '</td>' +
            '<td><span class="seat-symbol ' + seatClass + '">' + flight.seats + '</span></td>';
    });
}


// ------------------------------------------
// ▼▼▼ ページ読み込み時のメイン処理 (修正) ▼▼▼
// ------------------------------------------
window.onload = function() {
    var depCode = getParameterByName('dep');
    var arrCode = getParameterByName('arr');
    var month = getParameterByName('month');
    var day = getParameterByName('day');

    var codeMap = { 'OKA': '那覇', 'MMY': '宮古', 'ISG': '石垣' };
    var depName = codeMap[depCode] || depCode;
    var arrName = codeMap[arrCode] || arrCode;
    var monthName = month ? month + '月' : '不明';

    var criteriaDisplay = document.getElementById('search-criteria-display');

    // 検索条件を表示
    if (criteriaDisplay && depCode && arrCode && month && day) {
        var htmlContent = '<font size="2"><b>【ご希望の検索条件】</b></font><br>' +
                          '<span>' + depName + ' (' + depCode + ') → ' + arrName + ' (' + arrCode + ')</span><br>' +
                          '<span>搭乗日: 2025年 ' + monthName + ' ' + day + '日</span>';
        criteriaDisplay.innerHTML = htmlContent;

        // ★★★ ここで動的テーブル生成関数を実行 ★★★
        generateFlightTable(depCode, arrCode);

    } else if (criteriaDisplay) {
        criteriaDisplay.innerHTML = '<font color="red"><b>検索パラメータが正しくありません。トップページからやり直してください。</b></font>';
    }
// ★★★ 予約フォームに日付と路線情報を隠しフィールドで引き継ぐ処理 ★★★
    
    // ページ上のフォーム要素を取得します
    var bookingForm = document.querySelector('form'); 
    
    if (bookingForm) {
        // 隠しフィールドを作成して、現在のURLパラメータを次のページに渡す
        bookingForm.innerHTML += '<input type="hidden" name="dep" value="' + depCode + '">';
        bookingForm.innerHTML += '<input type="hidden" name="arr" value="' + arrCode + '">';
        bookingForm.innerHTML += '<input type="hidden" name="month" value="' + month + '">';
        bookingForm.innerHTML += '<input type="hidden" name="day" value="' + day + '">';
    }

}; // window.onloadの終わり

// ------------------------------------------
// ▼▼▼ 絞り込み機能 (時刻フィルタリング) (修正) ▼▼▼
// ------------------------------------------
function filterFlights(targetHour) {
    var table = document.getElementById('flight-results-table');
    if (!table) return;

    var rows = table.querySelectorAll('tr');

    for (var i = 1; i < rows.length; i++) {
        var row = rows[i];
        
        // 3番目のセル(出発時刻)
        var timeCell = row.cells[2]; 
        
        if (timeCell) {
            var timeText = timeCell.textContent || timeCell.innerText; 
            var hourMatch = timeText.match(/(\d{2}):\d{2}/);
            var hour = hourMatch ? parseInt(hourMatch[1]) : null;

            if (hour !== null) {
                var display = (hour === parseInt(targetHour)) ? '' : 'none';
                row.style.display = display;
            }
        }
    }
}

function resetFilter() {
    var table = document.getElementById('flight-results-table');
    if (!table) return;

    var rows = table.querySelectorAll('tr');
    
    for (var i = 1; i < rows.length; i++) {
        rows[i].style.display = ''; 
    }
}
</script>

</body>
</html>